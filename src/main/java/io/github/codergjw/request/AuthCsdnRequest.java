package io.github.codergjw.request;import io.github.codergjw.cache.AuthStateCache;import io.github.codergjw.config.AuthConfig;import io.github.codergjw.config.AuthDefaultSource;import io.github.codergjw.entity.AuthCallback;import io.github.codergjw.entity.AuthToken;import io.github.codergjw.entity.AuthUser;import io.github.codergjw.enums.AuthUserGender;import com.alibaba.fastjson.JSONObject;/** * @ClassName: AuthCsdnRequest * @Author: 小飞 * @Date: 2023/5/11 14:55 * @Description: CSDN 登录授权请求处理类 */public class AuthCsdnRequest extends AuthDefaultRequest{    public AuthCsdnRequest(AuthConfig config) {        super(config, AuthDefaultSource.CSDN);    }    public AuthCsdnRequest(AuthConfig config, AuthStateCache authStateCache) {        super(config, AuthDefaultSource.CSDN, authStateCache);    }    @Override    protected AuthToken getAccessToken(AuthCallback authCallback) {        String response = doPostAuthorizationCode(authCallback.getCode());        JSONObject accessTokenObject = JSONObject.parseObject(response);        this.checkResponse(accessTokenObject);        return AuthToken.builder().accessToken(accessTokenObject.getString("access_token")).build();    }    @Override    protected AuthUser getUserInfo(AuthToken authToken) {        String response = doGetUserInfo(authToken);        JSONObject object = JSONObject.parseObject(response);        this.checkResponse(object);        return AuthUser.builder()                .rawUserInfo(object)                .uuid(object.getString("username"))                .username(object.getString("username"))                .remark(object.getString("description"))                .blog(object.getString("website"))                .gender(AuthUserGender.UNKNOWN)                .token(authToken)                .source(source.toString())                .build();    }}